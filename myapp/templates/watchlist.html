{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>My Watchlist</title>
    <link rel="stylesheet" type="text/css" href="{% static 'styles.css' %}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Caprasimo&family=League+Spartan:wght@100..900&family=Passion+One:wght@400;700;900&family=Ultra&family=Young+Serif&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Single Alpine.js include -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body>
    <main x-data="watchlistApp()">
        <div class="watchlist-container">
            <div class="watchlist-tabs">
                <button @click="currentTab = 'watching'" 
                        :class="{ active: currentTab === 'watching' }">
                    Currently Watching
                </button>
                <button @click="currentTab = 'plan_to_watch'"
                        :class="{ active: currentTab === 'plan_to_watch' }">
                    Plan to Watch
                </button>
                <button @click="currentTab = 'completed'"
                        :class="{ active: currentTab === 'completed' }">
                    Completed
                </button>
            </div>

            <template x-for="item in filteredItems" :key="item.id">
                <div class="watchlist-item">
                    <img :src="item.poster_path" :alt="item.title">
                    <div class="item-info">
                        <h3 x-text="item.title"></h3>
                        <div class="progress-tracker">
                            <input type="number" x-model="item.progress">
                            <span>/ <span x-text="item.total_episodes || '?'"></span></span>
                        </div>
                        <select x-model="item.status" @change="updateStatus(item)">
                            <option value="watching">Currently Watching</option>
                            <option value="plan_to_watch">Plan to Watch</option>
                            <option value="completed">Completed</option>
                            <option value="dropped">Dropped</option>
                        </select>
                    </div>
                </div>
            </template>
        </div>
    </main>
    <script src="{% static 'watchlist.js' %}"></script>
</body>
</html>